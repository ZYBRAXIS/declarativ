!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?exports.declarativ=t(require("jquery")):e.declarativ=t(e.jQuery)}(window,function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){const r=n(1),{Component:o}=n(3);function a(e){return function(...t){return e.withChildrenArray(t)}}async function s(e,t){return console.log("rendering",e),e.render(null,t)}e.exports={Component:o,wrapCompose:a,compose:function(e){return a(new o(e))},render:s,renderElement:async function(e,t){let n=r("<template></template>");return e.empty(),e.append(n),s(t,n)}}},function(t,n){t.exports=e},function(e,t,n){const{compose:r,wrapCompose:o,render:a,renderElement:s}=n(0),i=n(5);e.exports={compose:r,wrapCompose:o,render:a,renderElement:s,elements:i}},function(e,t,n){const r=n(1),{DataResolvable:o,PendingTasks:a,forEachAsync:s,escapeHtml:i}=n(4);class l{constructor(e){this.children=(e||[]).map(e=>new o(e)),this.data=new o(e=>e)}withChildren(...e){return this.withChildrenArray(e)}withChildrenArray(e){let t=this.clone();return t.children=e.map(e=>new o(e)),t}bind(e){let t=this.clone();return t.data=new o(e),t}clone(){return Object.assign(Object.create(Object.getPrototypeOf(this)),this)}isBlocking(){return!1}async resolveChildren(e){let t=[],n=async function(r){let o=await r.resolve(e);o instanceof Array?await Promise.all(Object.values(o).map(n)):t.push(function(e){if(e instanceof l)return e;if("string"==typeof e)return new c(e);throw"declarativ: Cannot resolve passed node: "+e}(o))};return console.log(this.children),await Promise.all(Object.values(this.children).map(n)),t}async renderString(e){throw"No renderString implementation"}async render(e,t){throw"No render implementation."}}class c extends l{constructor(e){super(),this.text=e}async renderString(e){return i(this.text)}async render(e,t){let n=r(document.createTextNode(this.text));return t&&(n.insertBefore(t),t.remove()),n}}class u extends l{constructor(e,t){super(t),this.template=e,this.tasks=new a}run(e){let t=this.clone();return t.tasks=new a(this.tasks).push(e),t}forEach(...e){return this.withChildren(function(t){return Object.values(t).map(t=>e.map(function(e){return e instanceof u?e.bind(t):new o(e).resolve(t)}))})}isBlocking(){return!0}async renderString(e){let t=await this.data.resolve(e),n="";return await s(await this.resolveChildren(t),async function(t){n+=await t.renderString(e)}),this.template(n,t)}async render(e,t){let n=await this.data.resolve(e),o="",a={};await s(await this.resolveChildren(n),async function(t){if(t.isBlocking()){let e=`render-${Math.floor(1e3*Math.random())}-${Date.now()}`;o+=`<template id="${e}"></template>`,a[e]=t}else o+=await t.renderString(e)});let i=r(this.template(o,n));return await this.tasks.call(i,n),t&&(i.insertBefore(t),t.remove()),await Promise.all(Object.keys(a).map(function(e){let t=i.find(`template#${e}`);return a[e].render(n,t)})),i}}e.exports={Component:u}},function(e,t){class n{constructor(e){this.value=e instanceof n?e.value:e}isBlocking(){return this.value instanceof Promise}async resolve(e){return this.value instanceof Promise?await this.value:"function"==typeof this.value?this.value(e):this.value}}class r{constructor(e){e instanceof r?this.tasks=Object.values(e.tasks):e instanceof Array?this.tasks=Object.values(e):this.tasks=[]}push(e){return this.tasks.push(e),this}async call(...e){return Promise.all(this.tasks.map(function(t){let n=t.apply(null,e);return n instanceof Promise?n:Promise.resolve()}))}}e.exports={DataResolvable:n,PendingTasks:r,forEachAsync:async function(e,t){for(let n in Object.values(e))await t(e[n],n)},escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}}},function(e,t,n){const{compose:r}=n(0),o=t.element=function(e){return r(t=>`<${e}>${t}</${e}>`)};["address","article","aside","footer","header","h1","h2","h3","h4","h5","hgroup","main","nav","section","blockquote","div","hr","li","main","ol","p","pre","ul","a","br","code","em","i","small","span","strong","sub","sup","time","area","audio","img","map","track","video","embed","iframe","noembed","object","picture","source","canvas","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr","button","datalist","fieldset","form","input","label","legend","meter","optgroup","option","select","textarea","details","summary"].forEach(e=>{t[e]=o(e)})}])});